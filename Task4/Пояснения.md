# Ключевые процессы и компоненты (затрагиваются миграцией)

| Категория | Компоненты / Процессы |
|----------|------------------------|
| **Пользовательские интерфейсы и данные** | Запись/карточки пациентов, портал пациента и сотрудников |
| **Внешние интеграции** | Интеграция с лабораторией (API), ККМ, 1С, файлы/сканы |
| **Безопасность и управление доступом** | Идентификация и авторизация (SSO/MFA), политики (RBAC/ABAC) |
| **Хранилища данных** | Postgres (операционный контур), объектное хранилище, ClickHouse (аналитика) |
| **Инфраструктура** | Kubernetes, сетевые компоненты, хранилища (IOPS), сервис-меш |
| **Мониторинг и безопасность** | Наблюдаемость/аудит/DLP, безопасность (mTLS, KMS) |
| **Данные и миграция** | ETL/ингест, обезличивание, миграция данных и обратная совместимость |

# Рекомендации по устранению узких мест

| Мера | Что адресует | Как измерим успех | Приоритет |
|------|---------------|-------------------|-----------|
| **Границы сервисов и анти-corruption слой (strangler)** | “Разделённый монолит”, общая БД | Независимые деплои, снижение кросс-зависимостей | Высокий |
| **Асинхронность: брокер + outbox/CDC + идемпотентность + SAGA** | Двухзапись, длинные синхронные цепочки | Падение 95p латентности, отсутствие дублей | Высокий |
| **API-шлюз + лимиты + WAF + кэширование** | Чаттеринг, всплески трафика | Меньше 429/5xx, стабильный p99 | Высокий |
| **Наблюдаемость: трассировки, метрики SLO, логи, алерты** | Неясные причины деградаций | MTTR↓, соблюдение SLO, видимость p95/p99 | Высокий |
| **Надёжность: таймауты, ретраи с backoff, circuit-breaker, bulkhead** | Ретрай-штормы, каскадные падения | Снижение инцидентов L3, устойчивость к сбоям | Высокий |
| **БД и хранилища: пул соединений, индексы, чтение-реплики, IOPS класс** | Узкие места Postgres/хранилищ | Рост TPS без деградации p95, отсутствие lock-штормов | Высокий |
| **HA IdP/OPA с кэшированием решений, лимит QPS к KMS** | Узкие места безопасности | <5 мс на авторизацию, 0 троттлинга KMS | Высокий |
| **План миграции данных: бэкфилл без остановки, двойная запись, canary/cutover/rollback** | Долгие окна, риски отката | Cutover < 30 мин, 0 потерь, проверка целостности | Высокий |
| **Тестирование: контракт-тесты, нагрузочные профили, chaos/DR-дни** | Сюрпризы на проде | Успех DR-репетиций, стабильные перф-профили | Средний |
| **Интеграции внешние: очереди/кэши/ограничители, контракт-моки** | Лимиты 1С/Лаб/ККМ | Нет простоев при сбоях партнёров | Средний |
| **Процессы релизов: blue/green, canary, feature-flags, change-gates** | “Большой взрыв”, откаты | Безопасные релизы, снижение фейлов деплоев | Средний |
| **Подготовка команд: обучение K8s/obs/сагам, runbooks, on-call** | Дефицит навыков/операционки | Время реакции↓, меньше эскалаций | Средний |
| **Безопасность каналов и данных: mTLS, секреты, DLP-правила tuning** | Блокировки/ложные срабатывания | Ноль утечек, низкий false positive | Средний |
| **DR/бэкапы/иммутабельность: регулярные тесты восстановления** | Риски потери данных | Время восстановления в рамках RTO/RPO | Средний |